var frame,tawcvs=tawcvs||{};jQuery(document).ready(function($){"use strict";var wp=window.wp,$body=$("body");$("#term-color,#term-secondary-color").wpColorPicker();$body.on("click",".tawcvs-upload-image-button",function(event){event.preventDefault();var $button=$(this);if(frame){frame.open();return}frame=wp.media.frames.downloadable_file=wp.media({title:tawcvs.i18n.mediaTitle,button:{text:tawcvs.i18n.mediaButton},multiple:false});frame.on("select",function(){var attachment=frame.state().get("selection").first().toJSON();$button.siblings("input.tawcvs-term-image").val(attachment.id);$button.siblings(".tawcvs-remove-image-button").show();$button.parent().prev(".tawcvs-term-image-thumbnail").find("img").attr("src",attachment.sizes.thumbnail.url)});frame.open()}).on("click",".tawcvs-remove-image-button",function(){var $button=$(this);$button.siblings("input.tawcvs-term-image").val("");$button.siblings(".tawcvs-remove-image-button").show();$button.parent().prev(".tawcvs-term-image-thumbnail").find("img").attr("src",tawcvs.placeholder);return false});var $modal=$("#tawcvs-modal-container"),$spinner=$modal.find(".spinner"),$msg=$modal.find(".message"),$metabox=null;$body.on("click",".tawcvs_add_new_attribute",function(e){e.preventDefault();var $button=$(this),taxInputTemplate=wp.template("tawcvs-input-tax"),data={type:$button.data("type"),tax:$button.closest(".woocommerce_attribute").data("taxonomy")};$modal.find(".tawcvs-term-swatch").html($("#tmpl-tawcvs-input-"+data.type).html());$modal.find(".tawcvs-term-tax").html(taxInputTemplate(data));if("color"===data.type){$modal.find("input.tawcvs-input-color").wpColorPicker()}$metabox=$button.closest(".woocommerce_attribute.wc-metabox");$modal.show()}).on("click",".tawcvs-modal-close, .tawcvs-modal-backdrop",function(e){e.preventDefault();closeModal()});$body.on("click",".tawcvs-new-attribute-submit",function(e){e.preventDefault();var $button=$(this),type=$button.data("type"),error=false,data={};$modal.find(".tawcvs-input").each(function(){var $this=$(this);if($this.attr("name")!=="slug"&&!$this.val()){$this.addClass("error");error=true}else{$this.removeClass("error")}data[$this.attr("name")]=$this.val()});if(error){return}$spinner.addClass("is-active");$msg.hide();wp.ajax.send("tawcvs_add_new_attribute",{data:data,error:function(res){$spinner.removeClass("is-active");$msg.addClass("error").text(res).show()},success:function(res){$spinner.removeClass("is-active");$msg.addClass("success").text(res.msg).show();$metabox.find("select.attribute_values").append('<option value="'+res.id+'" selected="selected">'+res.name+"</option>");$metabox.find("select.attribute_values").change();closeModal()}})});function closeModal(){$modal.find(".tawcvs-term-name input, .tawcvs-term-slug input").val("");$spinner.removeClass("is-active");$msg.removeClass("error success").hide();$modal.hide()}$("#tawcvs-settings-wrap :input").each(function(key){$(this).change(function(){$(this).addClass("dirty")})});$body.on("click","#tawcvs_save_settings",function(e){e.preventDefault();const data=JSON.parse(getAllValues());let savingNoticeEle=$(".wcvs-saving-notice");$(".wcvs-notice").hide();savingNoticeEle.fadeIn();wp.ajax.send("tawcvs_save_settings",{data:data,error:function(res){savingNoticeEle.hide();$(".wcvs-failed-notice").fadeIn().delay(5e3).fadeOut()},success:function(res){savingNoticeEle.hide();$(".wcvs-saved-notice").fadeIn().delay(5e3).fadeOut()}})});function getAllValues(){var inputValues="{";$("#tawcvs-settings-wrap :input").map(function(){var type=$(this).prop("type");if(type==="checkbox"){if(this.checked){inputValues=inputValues.concat('"'+$(this).attr("name")+'":'+'"1",')}else{inputValues=inputValues.concat('"'+$(this).attr("name")+'":'+'"0",')}}else if(type==="radio"){if(this.checked){inputValues=inputValues.concat('"'+$(this).attr("name")+'":'+'"'+$(this).val()+'",')}}else if(type!=="button"&&type!=="submit"){inputValues=inputValues.concat('"'+$(this).attr("name")+'":'+'"'+$(this).val()+'",')}});return inputValues.slice(0,-1).concat("}")}});jQuery(document).ready(function($){$(".variation-item-head").on("click",function(){var $clickedHead=$(this);$(".variation-item-head").each(function(){if($(this).is($clickedHead)){}else{$(this).removeClass("active-accordion");$(this).next().slideUp()}});$clickedHead.next().slideToggle();$clickedHead.toggleClass("active-accordion")});$(".accor-tab-btn").on("click",function(){var index=$(this).index();$(".accor-tab-btn").removeClass("active-at-btn");$(this).addClass("active-at-btn");$(".wcvs-accor-tab-content").hide().eq(index).show()});$(".wcvs-accordion-switch").change(function(){var wcvs_accordion_target=$(this).attr("data-target");if(this.checked){$(wcvs_accordion_target).slideDown()}else{$(wcvs_accordion_target).slideUp()}});$(function(){$(".vs-color-picker").wpColorPicker()});const isDualColorEle=$("#term-is-dual-color");const secondaryColorEle=$(".tawcvs-dual-color-select");if(isDualColorEle.length){isDualColorEle.on("change",function(){const currentConditionalField=$(this);if(currentConditionalField.is(":checked")){secondaryColorEle.removeClass("hidden")}else if(!currentConditionalField.hasClass("hidden")){secondaryColorEle.addClass("hidden")}});isDualColorEle.trigger("change")}$(".wcvs-pro-item").on("click",function(){$(".pro-feature-popup,.pro-features-blur").show()});$(".popup-close,.pro-features-blur").on("click",function(){$(".pro-feature-popup,.pro-features-blur").hide()})});